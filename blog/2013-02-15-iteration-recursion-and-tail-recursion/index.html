<!doctype html><html class="not-ready text-sm lg:text-base" style=--bg:#f1efe1 lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><title>Iteration, Recursion and Tail recursion - siliconsenthil</title><meta name=theme-color><meta name=description content="Courtesy: Functional Programming Principles in Scala
Problem: Given a and b,find the sum of range of numbers between a and b.E.g. Given 1 and 4, the result is 10 (1+2+3+4). Simple.
Language: Scala
Let&rsquo;s do this with programmers&rsquo; favorite, Iteration"><meta name=author content><link rel="preload stylesheet" as=style href=https://siliconsenthil.in/main.min.css><script defer src=https://siliconsenthil.in/highlight.min.js onload=hljs.initHighlightingOnLoad()></script>
<link rel=preload as=image href=https://siliconsenthil.in/theme.png><link rel=preload as=image href=https://www.gravatar.com/avatar/b78415ec052d8811a4f31c4746cbde9f><link rel=preload as=image href=https://siliconsenthil.in/twitter.svg><link rel=preload as=image href=https://siliconsenthil.in/github.svg><link rel=preload as=image href=https://siliconsenthil.in/rss.svg><link rel=icon href=https://siliconsenthil.in/favicon.ico><link rel=apple-touch-icon href=https://siliconsenthil.in/apple-touch-icon.png><meta name=generator content="Hugo 0.101.0"><meta property="og:title" content="Iteration, Recursion and Tail recursion"><meta property="og:description" content="Understanding the differences between Iteraion, Recursion and Tail Recursion using a Scala example."><meta property="og:type" content="article"><meta property="og:url" content="https://siliconsenthil.in/blog/2013-02-15-iteration-recursion-and-tail-recursion/"><meta property="article:section" content="blog"><meta property="article:published_time" content="2013-02-15T12:38:00+05:30"><meta property="article:modified_time" content="2013-02-15T12:38:00+05:30"><meta itemprop=name content="Iteration, Recursion and Tail recursion"><meta itemprop=description content="Understanding the differences between Iteraion, Recursion and Tail Recursion using a Scala example."><meta itemprop=datePublished content="2013-02-15T12:38:00+05:30"><meta itemprop=dateModified content="2013-02-15T12:38:00+05:30"><meta itemprop=wordCount content="338"><meta itemprop=keywords content><meta name=twitter:card content="summary"><meta name=twitter:title content="Iteration, Recursion and Tail recursion"><meta name=twitter:description content="Understanding the differences between Iteraion, Recursion and Tail Recursion using a Scala example."></head><body class="text-black duration-200 ease-out dark:text-white"><header class="mx-auto flex h-[5rem] max-w-3xl px-8 lg:justify-center"><div class="relative z-50 mr-auto flex items-center"><a class="-translate-x-[1px] -translate-y-0.5 text-3xl font-bold" href=https://siliconsenthil.in/>siliconsenthil</a>
<a class="btn-dark ml-6 h-6 w-6 shrink-0 cursor-pointer [background:url(./theme.png)_left_center/_auto_theme('spacing.6')_no-repeat] [transition:_background-position_0.4s_steps(5)] dark:[background-position:right]"></a></div><a class="btn-menu relative z-50 -mr-8 flex h-[5rem] w-[5rem] shrink-0 cursor-pointer flex-col items-center justify-center gap-2.5 lg:hidden"></a>
<script>const htmlClass=document.documentElement.classList;setTimeout(()=>{htmlClass.remove("not-ready")},10);const btnMenu=document.querySelector(".btn-menu");btnMenu.addEventListener("click",()=>{htmlClass.toggle("open")});const metaTheme=document.querySelector('meta[name="theme-color"]'),lightBg=`"#f1efe1"`.replace(/"/g,""),setDark=e=>{metaTheme.setAttribute("content",e?"#000":lightBg),htmlClass[e?"add":"remove"]("dark"),localStorage.setItem("dark",e)},darkScheme=window.matchMedia("(prefers-color-scheme: dark)"),darkVal=localStorage.getItem("dark");setDark(darkVal?darkVal==="true":darkScheme.matches),darkScheme.addEventListener("change",e=>{setDark(e.matches)});const btnDark=document.querySelector(".btn-dark");btnDark.addEventListener("click",()=>{setDark(localStorage.getItem("dark")!=="true")})</script><div class="nav-wrapper fixed inset-x-0 top-full z-40 flex h-full select-none flex-col justify-center pb-16 duration-200 dark:bg-black lg:static lg:h-auto lg:flex-row lg:!bg-transparent lg:pb-0 lg:transition-none"><nav class="mt-12 flex justify-center space-x-10 dark:invert lg:mt-0 lg:ml-12 lg:items-center lg:space-x-6"><a class="h-8 w-8 [background:var(--url)_center_center/cover_no-repeat] lg:h-6 lg:w-6" style=--url:url(./twitter.svg) href=https://twitter.com/siliconsenthil target=_blank></a>
<a class="h-8 w-8 [background:var(--url)_center_center/cover_no-repeat] lg:h-6 lg:w-6" style=--url:url(./github.svg) href=https://github.com/siliconsenthil target=_blank></a>
<a class="h-8 w-8 [background:var(--url)_center_center/cover_no-repeat] lg:h-6 lg:w-6" style=--url:url(./rss.svg) href=https://siliconsenthil.in/index.xml target=_blank></a></nav></div></header><main class="prose prose-neutral relative mx-auto min-h-[calc(100%-10rem)] max-w-3xl px-8 pt-20 pb-32 dark:prose-invert"><article><header class=mb-20><h1 class="!my-0 pb-2.5">Iteration, Recursion and Tail recursion</h1><div class="text-sm opacity-60"><time>Feb 15, 2013</time></div></header><section><p>Courtesy: <a href=https://class.coursera.org/progfun-2012-001/class/index>Functional Programming Principles in Scala</a></p><p><strong>Problem:</strong> Given <em>a</em> and <em>b</em>,<br>find the sum of range of numbers between <em>a</em> and <em>b</em>.<br>E.g. Given 1 and 4, the result is 10 (1+2+3+4). Simple.</p><p><strong>Language:</strong> Scala</p><p>Let&rsquo;s do this with programmers&rsquo; favorite, Iteration</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-scala data-lang=scala><span style=display:flex><span>    <span style=color:#66d9ef>def</span> iterative_sum<span style=color:#f92672>(</span>a<span style=color:#66d9ef>:</span> <span style=color:#66d9ef>Long</span><span style=color:#f92672>,</span> b<span style=color:#66d9ef>:</span> <span style=color:#66d9ef>Long</span><span style=color:#f92672>)</span><span style=color:#66d9ef>:</span><span style=color:#66d9ef>Long</span> <span style=color:#f92672>=</span>  <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>var</span> result <span style=color:#66d9ef>=</span> <span style=color:#ae81ff>0L</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>for</span><span style=color:#f92672>(</span>i <span style=color:#66d9ef>&lt;-</span> a until b<span style=color:#f92672>){</span>result<span style=color:#66d9ef>=</span>result<span style=color:#f92672>+</span>i<span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>return</span> result<span style=color:#f92672>+</span>b<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span></code></pre></div><p>If we had to do this with recursion,</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-scala data-lang=scala><span style=display:flex><span><span style=color:#66d9ef>def</span> sum<span style=color:#f92672>(</span>a<span style=color:#66d9ef>:</span> <span style=color:#66d9ef>Long</span><span style=color:#f92672>,</span> b<span style=color:#66d9ef>:</span> <span style=color:#66d9ef>Long</span><span style=color:#f92672>)</span><span style=color:#66d9ef>:</span> <span style=color:#66d9ef>Long</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>if</span><span style=color:#f92672>(</span>a <span style=color:#f92672>&gt;</span> b<span style=color:#f92672>)</span> <span style=color:#ae81ff>0</span> <span style=color:#66d9ef>else</span> a <span style=color:#f92672>+</span> sum<span style=color:#f92672>(</span>a<span style=color:#f92672>+</span><span style=color:#ae81ff>1</span><span style=color:#f92672>,</span> b<span style=color:#f92672>)</span>
</span></span></code></pre></div><p>This works for smaller values. There&rsquo;s a problem with this for bigger values because the way it&rsquo;s implemented. If we see how it works, it would be obvious to figure that out. Assume the red grid as a limited size stack.</p><p>{% img <a href=http://i50.tinypic.com/1218htk.png>http://i50.tinypic.com/1218htk.png</a> 410px %}</p><p>It keeps putting expressions to stack till it could evaluate to a value.
Now, you can see it throws <em>StackOverflowError</em> for larger input.</p><p>{% img <a href=http://i45.tinypic.com/2mw8ry1.png>http://i45.tinypic.com/2mw8ry1.png</a> 410px %}</p><p>This is the problem with recursion. This might be one reason programmers tend to avoid recursion as it might not be obvious to guess when it fails.</p><p>If we could write a recursion function that does not force to use stack then we can avoid this error. And that is called as tail recursion. The way to do is that the last line of the recursion function should be just the recursion and not something else to do with the result.</p><p>With the help of nested function construct in scala, we could write something like this. Here <code>loop(a+1, acc+a)</code> is the recusion call. As you can see this is the only expression, it does not require stack to store intermediate result.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-scala data-lang=scala><span style=display:flex><span>    <span style=color:#66d9ef>def</span> tail_sum<span style=color:#f92672>(</span>a<span style=color:#66d9ef>:</span> <span style=color:#66d9ef>Long</span><span style=color:#f92672>,</span> b<span style=color:#66d9ef>:</span> <span style=color:#66d9ef>Long</span><span style=color:#f92672>)</span><span style=color:#66d9ef>:</span> <span style=color:#66d9ef>Long</span> <span style=color:#f92672>={</span>
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>def</span> loop<span style=color:#f92672>(</span>a<span style=color:#66d9ef>:</span> <span style=color:#66d9ef>Long</span><span style=color:#f92672>,</span> acc<span style=color:#66d9ef>:</span> <span style=color:#66d9ef>Long</span><span style=color:#f92672>)</span><span style=color:#66d9ef>:</span> <span style=color:#66d9ef>Long</span> <span style=color:#f92672>=</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span><span style=color:#f92672>(</span>a <span style=color:#f92672>&gt;</span> b<span style=color:#f92672>)</span> acc
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span> loop<span style=color:#f92672>(</span>a<span style=color:#f92672>+</span><span style=color:#ae81ff>1</span><span style=color:#f92672>,</span> acc<span style=color:#f92672>+</span>a<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>      loop<span style=color:#f92672>(</span>a<span style=color:#f92672>,</span> <span style=color:#ae81ff>0</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span> 
</span></span></code></pre></div><p>I tried the above all in for a large value (>6998 in my machine) and saw recursion failing while iteration and tail recursion are able to return result.</p><p>{% gist 4959395 IterationRecursionTailRecursion.scala %}</p></section><nav class="mt-24 flex rounded-lg bg-black/[3%] text-lg dark:bg-white/[8%]"><a class="flex w-1/2 items-center p-6 pr-3 no-underline" href=https://siliconsenthil.in/blog/2013-03-26-integer-dot-parseint-god/><span class=mr-1.5>←</span><span>Integer.parseInt('God') = ???</span></a>
<a class="ml-auto flex w-1/2 items-center justify-end p-6 pl-3 no-underline" href=https://siliconsenthil.in/blog/2013-01-19-validation-scopes-leaks-memory/><span>Memory leaks with validation_scopes</span><span class=ml-1.5>→</span></a></nav><div id=disqus_thread></div><script>const disqusShortname="siliconsenthil",script=document.createElement("script");script.src="https://"+disqusShortname+".disqus.com/embed.js",script.setAttribute("data-timestamp",+new Date),document.head.appendChild(script)</script></article></main><footer class="opaco mx-auto flex h-[5rem] max-w-3xl items-center px-8 text-[0.9em] opacity-60"><div class=mr-auto>&copy; 2022
<a class=link href=https://siliconsenthil.in/>siliconsenthil</a></div><a class="link mx-6" href=https://gohugo.io/ rel=noopener target=_blank>Powered by Hugo️️</a>️
<a class=link href=https://github.com/nanxiaobei/hugo-paper rel=noopener target=_blank>▷ Paper 6</a></footer></body></html>